!function(e,t){"function"==typeof define&&define.amd?define(["jquery"],function(e){return t(e)}):"object"==typeof module&&module.exports?module.exports=t(require("jquery")):t(e.jQuery)}(this,function(e){!function(e){"use strict";function t(t,n){var s=arguments,o=e(this),i=t,d=n;[].shift.apply(s);var l;if(o.is("table")){var r=o.data("BootstrapTreeTable"),p="object"==typeof i&&i;if(r){if(p)for(var h in p)p.hasOwnProperty(h)&&(r.options[h]=p[h])}else{var c=e.extend(!0,a.DEFAULTS,o.data(),p);o.data("BootstrapTreeTable",r=new a(this,c,d))}"string"==typeof i&&(l=r[i]instanceof Function?r[i].apply(r,s):r.options[i])}return void 0!==l?l:this}var n=".bs.treetable",a=function(t,n){this.$element=e(t),this.origin=this.$element.clone(),this.nodes=this.$element.find("tbody > tr"),this.root="tr[data-pid=''],tr[data-pid='root']",this.options=n,this.maxlevel=0,this.searchNodeId=a.prototype.searchNodeId,this.searchNodeName=a.prototype.searchNodeName,this.expendAll=a.prototype.expendAll,this.collapseAll=a.prototype.collapseAll,this.expendLevel=a.prototype.expendLevel,this.destroy=a.prototype.destroy,this.reset=a.prototype.reset,this.removeByNode=a.prototype.removeByNode,this.removeById=a.prototype.removeById,this.init()};a.VERSION="1.2.8",a.prototype={init:function(){var t=this;this.nodes.filter(this.root).each(function(){var n=e(this);n.data("level",0),t.dataHandler(n)}),this.clickListener(),setTimeout(function(){t.$element.trigger("initialized"+n)})},dataHandler:function(t){var n=this,a=t.data("id"),s=parseInt(t.data("level"))+1;n.maxlevel<s&&(n.maxlevel=s);var o=this.nodes.filter("tr[data-pid="+a+"]");t.data("leaf",0===o.length?1:0),n.setbranch(t),n.setDefaultExpand(t),o.each(function(){e(this).data("level",s);var t=""!==n.options.column?n.options.column:0,a=""!==n.options.levelSpacing?n.options.levelSpacing:20;e(this).children().eq(t).css("padding-left",s*a+"px"),n.dataHandler(e(this))})},setbranch:function(t){var n=""!==this.options.column?this.options.column:0,a=t.children().eq(n);if(a.wrapInner("<span class='nodename'></span>"),0===t.data("leaf")){var s=e('<a href="#"></a>').addClass("nodepoint").css("padding-right","5px").append(this.options.collapsedIcon);a.prepend(s)}else{var o;o=this.options.leafIcon?e(this.options.leafIcon).css({"padding-left":"0","padding-right":"5px"}):e("<span></span>").css("padding-left","17px"),a.prepend(o)}},setDefaultExpand:function(e){var t="undefined"!==this.options.expandlevel?this.options.expandlevel:0,n="undefined"!==this.options.expandAll&&this.options.expandAll,a="undefined"!==this.options.collapseAll&&this.options.collapseAll,s=e.data("level");return n?(this.setExpanded(e),void e.show()):a?(this.setCollapsed(e),void(0!==s&&e.hide())):void(t===s?(this.setCollapsed(e),e.show()):t>s?(this.setExpanded(e),e.show()):(this.setCollapsed(e),e.hide()))},clickListener:function(){var t=this;this.nodes.find(".nodepoint").on("click.bs.treetable",function(a){a.preventDefault();var s=e(this).parents("tr");s.hasClass("expended")?(s.trigger("hide"+n,s),t.setCollapsed(s),t.collapseHandler(s),s.trigger("hidden"+n,s)):(s.trigger("show"+n,s),t.setExpanded(s),t.expendHandler(s),s.trigger("shown"+n,s))})},setCollapsed:function(e){0!==e.data("leaf")||e.hasClass("collapsed")||(e.removeClass("expended"),e.addClass("collapsed"),e.find(".nodepoint").children().replaceWith(this.options.collapsedIcon))},setExpanded:function(e){0!==e.data("leaf")||e.hasClass("expended")||(e.removeClass("collapsed"),e.addClass("expended"),e.find(".nodepoint").children().replaceWith(this.options.expendedIcon))},collapseHandler:function(t){var n=this,a=t.data("id"),s=this.nodes.filter("tr[data-pid="+a+"]");s.hide(),s.each(function(){n.collapseHandler(e(this))})},expendHandler:function(t){var n=this,a=t.data("id"),s=this.nodes.filter("tr[data-pid="+a+"]");s.show(),s.filter('tr[class*="expended"]').each(function(){n.expendHandler(e(this))})},searchNodeId:function(t){var n=this,a=this.nodes.filter(function(){return e(this).data("id")===t});a.addClass(n.options.choseClass),n.setExpanded(a),n.expendHandler(a),n.expendParent(a)},searchNodeName:function(t){if(""===t||void 0===t)return 0;var n=this;n.collapseAll(),n.clearMatchStyle();var a=n.nodes.filter(function(){return-1!==e(this).find(".nodename").text().indexOf(e.trim(t))}),s=""!==n.options.maxResult?n.options.maxResult:20,o=""!==n.options.matchClass?n.options.matchClass:"text-danger";return a.length>s?alert("查询匹配结果过多，请重新查询"):a.each(function(){var t=e(this);t.find(".nodename").addClass(o),n.expendParent(t)}),a.length},expendParent:function(t){var n=this,a=t.data("pid"),s=this.nodes.filter("tr[data-id='"+a+"']");if(s.length>0){n.setExpanded(s),s.show();var o=s.data("id");n.nodes.each(function(){var t=e(this);t.data("pid")===o&&t.show()}),n.expendParent(s)}},expendAll:function(){var t=this;t.nodes.each(function(){var n=e(this);t.setExpanded(n),n.show()})},collapseAll:function(){var t=this;t.nodes.each(function(){var n=e(this);t.setCollapsed(n),0!==n.data("level")&&n.hide()})},expendLevel:function(t){var n=this;n.nodes.each(function(){var a=e(this),s=a.data("level");t===s?(n.setCollapsed(a),a.show()):t>s?(n.setExpanded(a),a.show()):(n.setCollapsed(a),a.hide())})},destroy:function(){this.nodes.find(".nodepoint").off(".bs.treetable"),this.$element.before(this.origin).remove()},reset:function(){var t=this;this.nodes.each(function(){t.setDefaultExpand(e(this))}),t.clearMatchStyle()},clearMatchStyle:function(){var e=""!==this.options.matchClass?this.options.matchClass:"text-danger";this.nodes.find(".nodename").removeClass(e)},setNode2Leaf:function(t){var n=this;this.nodes=this.$element.find("tbody > tr"),this.nodes.each(function(){var a=e(this),s=a.data("id");if(s===t){if(0===n.nodes.filter("tr[data-pid='"+s+"']").length){a.data("leaf","1"),a.removeClass("expended"),a.find(".nodepoint").remove();var o,i=""!==n.options.column?n.options.column:0,d=a.children().eq(i);o=n.options.leafIcon?e(n.options.leafIcon).css({"padding-left":"0","padding-right":"5px"}):e("<span></span>").css("padding-left","17px"),d.prepend(o)}return!1}})},removeByNode:function(e){var t=this;if(e&&1===e.data("leaf")){var n=e.data("pid");e.remove(),t.setNode2Leaf(n)}else 0===e.data("leaf")&&alert("请先删除子节点")},removeById:function(e){var t=this.nodes.filter('tr[data-id="'+e+'"]');this.removeByNode(t)},showLoading:function(){var t=this.$element.children("tbody").first();window.setTimeout(function(){var n=t.find("tr").first(),a=n.children().length,s=e("<td></td>").attr("colspan",a).appendTo(e("<tr></tr>"));t.prepend(s)},5e3)},getMaxLevel:function(){return this.maxlevel}},a.DEFAULTS={levelSpacing:20,column:0,expandlevel:0,expandAll:!1,collapseAll:!1,expendedIcon:'<span class="glyphicon glyphicon-minus"></span>',collapsedIcon:'<span class="glyphicon glyphicon-plus"></span>',leafIcon:'<span class="glyphicon glyphicon-leaf" ></span>',maxResult:20,matchClass:"text-danger",choseClass:"bg-info"};var s=e.fn.BootstrapTreeTable;e.fn.BootstrapTreeTable=t,e.fn.BootstrapTreeTable.Constructor=a,e.fn.BootstrapTreeTable.noConflict=function(){return e.fn.BootstrapTreeTable=s,this}}(e)});