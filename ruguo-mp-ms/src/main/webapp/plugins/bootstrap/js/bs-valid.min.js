!function(t,e){"use strict";function n(e,n){this.options=t.extend({},t.fn[a].defaults,n),this.$form=e,this.allowed_rules=[],this.fieldNames=[],this.errors={};var u=this;t.each(this.methods,function(t,e){u.allowed_rules.push(t)})}var a="bootValid";t.extend(n.prototype,{validate:function(){var e=this,n=this.$form.serializeArray(),a=this.$form.find(":input[name]").map(function(){return this.name}).get();return this.fieldNames=a,t.each(a,function(t,n){e.clearValidByName(n)}),this.errors={},t.each(e.options.rules,function(u,r){var i=null,s={};t.each(n,function(t,e){if(e.name===u)return i=e,!1}),null===i&&-1!==t.inArray(u,a)&&(i={name:u,value:e.get_field_value(u)}),null!==i&&(t.each(r,function(n,a){"string"===t.type(a)?-1!==t.inArray(a,e.allowed_rules)&&(s[a]=null):t.each(a,function(n,a){if(-1!==t.inArray(n,e.allowed_rules))return s[n]=a,!1})}),t.each(s,function(t,n){!0!==e.methods[t].call(e,i.name,i.value,n,s)&&(e.errors[i.name]=e.format.call(e,i.name,t,n))}))}),t.isEmptyObject(this.errors)?!e.options.validFiles||e.validFiles():(this.show(this.errors),e.options.validFiles&&e.validFiles(),!1)},appendMessage:function(e,n){var a=this,u=e.closest(a.options.wrapper).attr("data-msg-direction"),r=t("<span/>").addClass("pull-left control-label text-left-imp valid-message");if(void 0===u&&(u=a.options.direction),"r"===u){var i=e.closest(a.options.wrapper).children("span.valid-message").addClass("control-label");0===i.length?(r.css("padding-left",a.options.paddingLeft+"px"),r.html(n),e.closest(a.options.wrapper).append(r)):(i.css("padding-left",a.options.paddingLeft+"px"),i.html(n))}else if("d"===u){var s=e.siblings("span.valid-message").addClass("control-label");1==e.parent(".input-group").length?(e.parent(".input-group").parent().append(r),r.html(n)):0===s.length?("radio"===e.attr("type")||"checkbox"===e.attr("type")||e.hasClass("spinner")?e.parent().parent().append(r):e.parent().append(r),r.html(n)):s.html(n)}null!==a.options.wrapper&&e.closest(a.options.wrapper).addClass("has-error")},validFiles:function(){var e=this,n=this.$form.find(":file"),a=!0;return t.each(n,function(t,n){if(n.value)e.clearValidById(n.id);else{var u=e.$form.find("#"+n.id);e.appendMessage(u,e.messages.not_empty),a=!1}}),a},show:function(e){var n=this;t.each(e,function(t,e){var a=n.$form.find('[name="'+t+'"]');n.appendMessage(a,e)})},remove:function(e){var n=this;"string"==typeof e?n.clearValidByName(e):t.each(e,function(t,e){n.clearValidByName(e)})},removeAll:function(){var e=this;t.each(e.fieldNames,function(t,n){e.clearValidByName(n)})},clearValidByName:function(t){var e=this.$form.find('[name="'+t+'"]');this.clearValid(e)},clearValidById:function(t){var e=this.$form.find("#"+t);this.clearValid(e)},clearValid:function(t){if(t){var e=this;t.closest(e.options.wrapper).find("span.valid-message").html("").removeClass("control-label"),null!==e.options.wrapper&&t.closest(e.options.wrapper).removeClass("has-error")}},methods:{not_empty:function(e,n){return null!==n&&t.trim(n).length>0},min_length:function(e,n,a,u){var r=t.trim(n).length,i=r>=a;return u.not_empty||(i=i||0===r),i},max_length:function(e,n,a){return t.trim(n).length<=a},regex:function(t,e,n){return n.test(e)},email:function(e,n){if(null!==n&&t.trim(n).length>0){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(t.trim(n))}return!0},url:function(e,n){if(null!==n&&t.trim(n).length>0){return/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(n)}return!0},exact_length:function(e,n,a,u){var r=t.trim(n).length,i=r===a;return u.not_empty||(i=i||0===r),i},equals:function(t,e,n){return e===n},ip:function(e,n){if(null!==n&&t.trim(n).length>0){return/^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})$/i.test(t.trim(n))}return!0},credit_card:function(t,e){if(/[^0-9 \-]+/.test(e))return!1;var n=0,a=0,u=!1;e=e.replace(/\D/g,"");for(var r=e.length-1;r>=0;r--){var i=e.charAt(r);a=parseInt(i,10),u&&(a*=2)>9&&(a-=9),n+=a,u=!u}return n%10==0},alpha:function(t,e){return/^[a-z]*$/i.test(e)},alpha_numeric:function(t,e){return/^[a-z0-9]*$/i.test(e)},alpha_number:function(t,e){return/^[a-zA-z]\w{3,15}$/.test(e)},alpha_dash:function(t,e){return/^[a-z0-9_\-]*$/i.test(e)},alpha_organ:function(t,e){return/^[a-zA-Z0-9\-]{1,18}$/.test(e)},digit:function(t,e){return/^\d*$/.test(e)},numeric:function(t,e){return/^([\+\-]?[0-9]+(\.[0-9]+)?)?$/.test(e)},decimal:function(t,e){return/^([\+\-]?[0-9]+(\.[0-9]+)?)?$/.test(e)},matches:function(t,e,n){return e===this.$form.find('[name="'+n+'"]').val()},not_matches:function(t,e,n){return e!==this.$form.find('[name="'+n+'"]').val()},phone_num:function(e,n){if(null!==n&&t.trim(n).length>0){return/^(13[0-9]|14[0-9]|15[0-9]|18[0-9])\d{8}$/i.test(n)}return!0},tel:function(e,n){if(null!==n&&t.trim(n).length>0){return/^0\d{2,3}-?\d{7,8}$/.test(n)}return!0},id_num:function(e,n){if(null!==n&&t.trim(n).length>0){var a={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江 ",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北 ",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏 ",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外 "},u=!0;if(n&&/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/i.test(n))if(a[n.substr(0,2)]){if(18==n.length){n=n.split("");for(var r=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],i=[1,0,"X",9,8,7,6,5,4,3,2],s=0,F=0,o=0,l=0;l<17;l++)F=n[l],o=r[l],s+=F*o;i[s%11];i[s%11]!=n[17]&&("校验位错误",u=!1)}}else"地址编码错误",u=!1;else"身份证号格式错误",u=!1;return u}},ch_char:function(e,n){if(null!==n&&t.trim(n).length>0){return/^[\u4e00-\u9fa5]+$/.test(n)}return!0},date:function(e,n){if(null!==n&&t.trim(n).length>0){return/^((((1[6-9]|[2-9]\d)\d{2})-(0?[13578]|1[02])-(0?[1-9]|[12]\d|3[01]))|(((1[6-9]|[2-9]\d)\d{2})-(0?[13456789]|1[012])-(0?[1-9]|[12]\d|30))|(((1[6-9]|[2-9]\d)\d{2})-0?2-(0?[1-9]|1\d|2[0-8]))|(((1[6-9]|[2-9]\d)(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00))-0?2-29-))$/.test(n)}return!0},post:function(e,n){if(null!==n&&t.trim(n).length>0){return/^[1-9]\d{5}$/.test(n)}return!0},bank_count_no:function(e,n){if(null!==n&&t.trim(n).length>0){return/^(\d{16}|\d{19})$/.test(n)}return!0},strong_pwd:function(e,n){if(null!==n&&t.trim(n).length>0){return/(?=[-\da-zA-Z`=\\;',.\/~!@#$%^&*()_+|{}:"<>?]*((\d+[a-zA-Z]+[-`=\\;',.\/~!@#$%^&*()_+|{}:"<>?]+)|(\d+[-`=\\;',.\/~!@#$%^&*()_+|{}:"<>?]+[a-zA-Z]+)|([a-zA-Z]+\d+[-`=\\;',.\/~!@#$%^&*()_+|{}:"<>?]+)|([a-zA-Z]+[-`=\\;',.\/~!@#$%^&*()_+|{}:"<>?]+\d+)|([-`=\\;',.\/~!@#$%^&*()_+|{}:"<>?]+\d+[a-zA-Z]+)|([-`=\\;',.\/~!@#$%^&*()_+|{}:"<>?]+[a-zA-Z]+\d+))[-\da-zA-Z`=\\;',.\/~!@#$%^&*()_+|{}:"<>?]*)((?=.*[A-Z])(?=.*[a-z]))/.test(n)}return!0}},messages:{not_empty:"该项为必填项！",min_length:"请输入至少 :value 位有效值！",max_length:"请输入不大于 :value 位有效值！",regex:"",email:"请输入一个有效的邮箱地址！",url:"请输入一个有效的网址！",exact_length:"请输入 :value 位有效值！",equals:"",ip:"请输入一个有效的IP地址！",credit_card:"请输入有效的信用卡号码！",alpha:"请输入字符！",alpha_numeric:"存在非法字符！",alpha_number:"请输入合法字符！",alpha_dash:"存在非法字符！",digit:"请输入数字！",numeric:"请输入有效数字！",decimal:"请输入金额格式数字！",matches:"Must match the previous value.",not_matches:"Must not match the previous value.",phone_num:"请输入11位有效的手机号码",tel:"请输入正确电话号码，如0920-29392929",id_num:"请输入正确的身份证号码",ch_char:"只能输入汉字！",date:"日期格式错误，正确格式：2015-12-02",post:"请输入正确的邮政编码!",bank_count_no:"请输入正确的银行账户!",alpha_organ:"请输入合理字符，可以是数字，字母和横杠，最大长度为18位字符！",strong_pwd:"请输入包含大、小写字母、数字和符号的组合！"},format:function(e,n,a){var u;return u=void 0!==this.options.messages[e]&&void 0!==this.options.messages[e][n]?this.options.messages[e][n]:this.messages[n],"undefined"!==t.type(a)&&null!==a&&("boolean"!==t.type(a)&&"string"!==t.type(a)&&"number"!==t.type(a)||(a={value:a}),t.each(a,function(t,e){u=u.replace(new RegExp(":"+t,"ig"),e)})),u},get_field_value:function(t){var e=this.$form.find('[name="'+t+'"]');return e.is('[type="checkbox"], [type="radio"]')?e.is(":checked")?e.val():null:e.val()}}),t.fn[a]=function(e,u,r){return this.each(function(i,s){var F=t(s),o=F.data(a);if("object"===t.type(e)){if(!o){var l=t.extend({},t.fn[a].defaults,e,F.data());o=new n(F,l),F.data(a,o).attr("novalidate","novalidate")}return F.ajaxForm({beforeSerialize:function(){"function"==typeof o.options.onBeforeValidate&&o.options.onBeforeValidate.call(o)},beforeSubmit:function(){return o.validate()},dataType:"json",success:function(n,a,u,r){"fail"===n.status?"function"==typeof e.onFail&&!1===e.onFail.call(this,n,o,r)||o.show(n.data.errors):"error"===n.status?"function"==typeof e.onError&&!1===e.onError.call(this,n,o,r)||t.scojs_message(n.message,t.scojs_message.TYPE_ERROR):"success"===n.status&&("function"==typeof e.onSuccess&&!1===e.onSuccess.call(this,n,o,r)||(n.data.next&&("."===n.data.next?window.location.href=window.location.href.replace(/#.*$/,""):"x"===n.data.next?r.closest(".modal").trigger("close"):window.location.href=n.data.next),n.data.message&&t.scojs_message(n.data.message,t.scojs_message.TYPE_OK)))}}),this}return"option"===e?"undefined"===t.type(r)?o.options[u]:(o.options[u]=r,o):o||this})},t[a]=function(e,a){return"string"==typeof e&&(e=t(e)),new n(e,a)},t.fn[a].defaults={wrapper:".form-group",direction:"r",rules:{},messages:{},paddingLeft:10,validFiles:!1}}(jQuery);